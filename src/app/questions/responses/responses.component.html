<div>
  <form (ngSubmit)="onSubmit()" class="row" [formGroup]="form">
    <div class="date-input-group">
      <mat-form-field (click)="startDatePicker.open()" class="date-input">
        <input
          matInput
          [matDatepicker]="startDatePicker"
          formControlName="startDate"
          (ngModelChange)="dateChange($event)"
          [readonly]="true"
          placeholder="Start Date"
        >
      </mat-form-field>
        <mat-datepicker-toggle [for]="startDatePicker"></mat-datepicker-toggle>
        <mat-datepicker #startDatePicker></mat-datepicker>
    </div>

    <div class="date-input-group">
      <mat-form-field (click)="endDatePicker.open()" class="date-input">
        <input
          matInput
          [matDatepicker]="endDatePicker"
          formControlName="endDate"
          [min]="minDate"
          [readonly]="true"
          placeholder="End Date"
        >
      </mat-form-field>
        <mat-datepicker-toggle [for]="endDatePicker"></mat-datepicker-toggle>
        <mat-datepicker #endDatePicker></mat-datepicker>
    </div>

    <div>
      <button mat-raised-button class="submit-button" color="primary" type="submit" [disabled]="!form.valid">View Responses</button>
    </div>
  </form>
</div>

<div *ngIf="finalCount.length >= 1">
  <!-- <div *ngFor="let question of finalCount">
    Question: {{question[0]}}<br>
    Responses:
    <div class="row" *ngFor="let answer of question[1]">
      {{answer[0]}}: {{answer[1]}}
    </div>
  </div> -->

  <div *ngFor="let question of finalCount" class="question">
    {{question[0]}}
    <div class="question-table mat-elevation-z8">
      <table mat-table [dataSource]="question[1]">

        <!-- Response Column -->
        <ng-container matColumnDef="response">
          <th mat-header-cell *matHeaderCellDef> Response </th>
          <td mat-cell *matCellDef="let answer"> {{answer[0]}} </td>
        </ng-container>

        <!-- Quantity Column -->
        <ng-container matColumnDef="quantity">
          <th mat-header-cell *matHeaderCellDef> Quantity </th>
          <td mat-cell *matCellDef="let answer"> {{answer[1]}} </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
      </table>
    </div>

  </div>
</div>

<div *ngIf="isLoading">
    <mat-progress-bar mode="indeterminate"></mat-progress-bar>
</div>
